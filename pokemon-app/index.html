<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PokeAPI - Mundo Pokémon Completo</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-image: url('https://images.unsplash.com/photo-1542779283-429940ce8336?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80'); /* Fundo Pokémon Fire (Charizard) */
            background-size: cover; 
            background-position: center; 
            color: white; 
            text-align: center; 
            padding: 20px; 
            min-height: 100vh; 
            margin: 0; 
        }
        .intro { 
            background: rgba(0, 0, 0, 0.7); 
            padding: 40px; 
            border-radius: 10px; 
            max-width: 600px; 
            margin: auto; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
        }
        .main { 
            display: none; /* Oculto por padrão */
            max-width: 1200px; 
            margin: auto; 
            background: rgba(255, 255, 255, 0.9); 
            padding: 20px; 
            border-radius: 10px; 
            box-shadow: 0 0 10px rgba(0,0,0,0.3); 
            color: black; 
        }
        h1 { font-size: 3em; margin-bottom: 20px; }
        p { font-size: 1.2em; margin-bottom: 30px; }
        button { 
            padding: 15px 30px; 
            background: #ffcc00; 
            border: none; 
            font-size: 1.2em; 
            cursor: pointer; 
            border-radius: 5px; 
            margin: 10px; 
        }
        button:hover { background: #ffb300; }
        .back-btn { background: #666; color: white; }
        .nav-btn { background: #4CAF50; color: white; }
        input { padding: 10px; width: 70%; margin: 10px 0; }
        .pokemon { margin: 20px 0; display: inline-block; width: 45%; vertical-align: top; }
        img { max-width: 150px; }
        #battleResult { margin-top: 20px; font-weight: bold; color: red; }
        .battle-images { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; }
        .battle-images img { max-width: 120px; }
        /* Estilos para o catálogo */
        .pokemon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .pokemon-card {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 15px;
            text-align: center;
        }
        .pokemon-card img {
            width: 100px;
            height: 100px;
        }
        .pokemon-card h3 {
            margin: 10px 0;
        }
        .pokemon-card p {
            color: #666;
            margin: 5px 0;
        }
        .types, .moves {
            margin-top: 10px;
        }
        .types ul, .moves ul {
            list-style: none;
            padding: 0;
        }
        .types li, .moves li {
            display: inline-block;
            background-color: #eee;
            padding: 2px 8px;
            margin: 2px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        /* Seções ocultas por padrão */
        .section { display: none; }
        .section.active { display: block; }
    </style>
</head>
<body>
    <!-- Página Inicial (Intro) -->
    <div id="intro" class="intro">
        <h1>Bem-vindo ao Mundo Pokémon!</h1>
        <p>Explore Pokémon, busque informações, simule batalhas e veja o catálogo completo com a PokeAPI. Clique em Iniciar para começar sua aventura!</p>
        <button onclick="showMain()">Iniciar</button>
    </div>

    <!-- Página Principal (Exploração, Batalha e Catálogo) -->
    <div id="main" class="main">
        <h1>Explorador, Batalha e Catálogo de Pokémon</h1>
        
        <!-- Navegação entre seções -->
        <div>
            <button class="nav-btn" onclick="showSection('search')">Buscar Pokémon</button>
            <button class="nav-btn" onclick="showSection('battle')">Simulação de Batalha</button>
            <button class="nav-btn" onclick="showSection('catalog')">Catálogo da Primeira Geração</button>
        </div>
        
        <!-- Seção de Busca -->
        <div id="search" class="section active">
            <h2>Buscar Pokémon</h2>
            <input type="text" id="pokemonInput" placeholder="Nome ou ID do Pokémon">
            <button onclick="searchPokemon()">Buscar</button>
            <div id="pokemonInfo"></div>
        </div>
        
        <!-- Seção de Batalha -->
        <div id="battle" class="section">
            <h2>Simulação de Batalha</h2>
            <p>Escolha dois Pokémon para batalhar:</p>
            <input type="text" id="pokemon1" placeholder="Pokémon 1 (ex: charizard)">
            <input type="text" id="pokemon2" placeholder="Pokémon 2 (ex: blastoise)">
            <button onclick="startBattle()">Iniciar Batalha</button>
            <div id="battleResult"></div>
        </div>
        
        <!-- Seção de Catálogo -->
        <div id="catalog" class="section">
            <h2>Catálogo de Pokémons - Primeira Geração</h2>
            <div id="pokemon-container" class="pokemon-grid"></div>
        </div>
        
        <!-- Botão para voltar -->
        <button class="back-btn" onclick="showIntro()">Voltar ao Início</button>
    </div>

    <script>
        // Função para mostrar a página principal
        function showMain() {
            document.getElementById('intro').style.display = 'none';
            document.getElementById('main').style.display = 'block';
        }

        // Função para voltar à intro
        function showIntro() {
            document.getElementById('main').style.display = 'none';
            document.getElementById('intro').style.display = 'flex';
        }

        // Função para mostrar seções
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
        }

        // Função de busca de Pokémon
        async function searchPokemon() {
            const input = document.getElementById('pokemonInput').value.toLowerCase();
            if (!input) return alert('Digite um nome ou ID!');

            try {
                const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${input}`);
                if (!response.ok) throw new Error('Pokémon não encontrado!');
                const data = await response.json();

                const types = data.types.map(t => t.type.name).join(', ');
                const abilities = data.abilities.map(a => a.ability.name).join(', ');

                document.getElementById('pokemonInfo').innerHTML = `
                    <div class="pokemon">
                        <h3>${data.name.toUpperCase()}</h3>
                        <img src="${data.sprites.front_default}" alt="${data.name}">
                        <p><strong>Tipos:</strong> ${types}</p>
                        <p><strong>Habilidades:</strong> ${abilities}</p>
                    </div>
                `;
            } catch (error) {
                document.getElementById('pokemonInfo').innerHTML = `<p style="color: red;">Erro: ${error.message}</p>`;
            }
        }

        // Função de simulação de batalha
        async function startBattle() {
            const p1 = document.getElementById('pokemon1').value.toLowerCase();
            const p2 = document.getElementById('pokemon2').value.toLowerCase();
            if (!p1 || !p2) return alert('Digite os nomes dos dois Pokémon!');

            try {
                const [res1, res2] = await Promise.all([
                    fetch(`https://pokeapi.co/api/v2/pokemon/${p1}`),
                    fetch(`https://pokeapi.co/api/v2/pokemon/${p2}`)
                ]);
                if (!res1.ok || !res2.ok) throw new Error('Um ou ambos os Pokémon não encontrados!');

                const data1 = await res1.json();
                const data2 = await res2.json();

                // Simulação simples: Calcular dano baseado em ataque vs defesa, com aleatoriedade
                const attack1 = data1.stats.find(s => s.stat.name === 'attack').base_stat;
                const defense2 = data2.stats.find(s => s.stat.name === 'defense').base_stat;
                const hp2 = data2.stats.find(s => s.stat.name === 'hp').base_stat;

                const attack2 = data2.stats.find(s => s.stat.name === 'attack').base_stat;
                const defense1 = data1.stats.find(s => s.stat.name === 'defense').base_stat;
                const hp1 = data1.stats.find(s => s.stat.name === 'hp').base_stat;

                // Dano = ataque - defesa + aleatório (0-20)
                const damage1 = Math.max(0, attack1 - defense2 + Math.floor(Math.random() * 20));
                const damage2 = Math.max(0, attack2 - defense1 + Math.floor(Math.random() * 20));

                let result = `
                    <div class="battle-images">
                        <div>
                            <h4>${data1.name.toUpperCase()}</h4>
                            <img src="${data1.sprites.front_default}" alt="${data1.name}">
                        </div>
                        <div>
                            <h4>${data2.name.toUpperCase()}</h4>
                            <img src="${data2.sprites.front_default}" alt="${data2.name}">
                        </div>
                    </div>
                    ${data1.name.toUpperCase()} ataca ${data2.name.toUpperCase()} causando ${damage1} de dano (HP restante: ${Math.max(0, hp2 - damage1)}).<br>
                    ${data2.name.toUpperCase()} ataca ${data1.name.toUpperCase()} causando ${damage2} de dano (HP restante: ${Math.max(0, hp1 - damage2)}).<br>
                `;

                if (damage1 > damage2) {
                    result += `<strong>${data1.name.toUpperCase()} vence!</strong>`;
                } else if (damage2 > damage1) {
                    result += `<strong>${data2.name.toUpperCase()} vence!</strong>`;
                } else {
                    result += `<strong>Empate!</strong>`;
                }

                document.getElementById('battleResult').innerHTML = result;
            } catch (error) {
                document.getElementById('battleResult').innerHTML = `<p style="color: red;">Erro: ${error.message}</p>`;
            }
        }

        // Funções para o catálogo
        const pokemonContainer = document.getElementById('pokemon-container');

        // Função para buscar Pokémons da PokeAPI
        async function fetchPokemons(limit = 151) {
            try {
                const response = await fetch(`https://pokeapi.co/api/v2/pokemon?limit=${limit}`);
                const data = await response.json();
                displayPokemons(data.results);
            } catch (error) {
                console.error('Erro ao buscar Pokémons:', error);
                pokemonContainer.innerHTML = '<p>Erro ao carregar os Pokémons. Tente novamente.</p>';
            }
        }

        // Função para exibir os Pokémons
        async function displayPokemons(pokemons) {
            pokemonContainer.innerHTML = ''; // Limpa o container
            for (const pokemon of pokemons) {
                try {
                    const response = await fetch(pokemon.url);
                    const details = await response.json();
                    
                    // Extrai tipos
                    const types = details.types.map(t => t.type.name.charAt(0).toUpperCase() + t.type.name.slice(1)).join(', ');
                    
                    // Extrai ataques básicos (primeiros 4 aprendidos no nível 1, ou primeiros disponíveis)
                    const basicMoves = details.moves
                        .filter(move => move.version_group_details.some(v => v.level_learned_at === 1))
                        .slice(0, 4)
                        .map(move => move.move.name.charAt(0).toUpperCase() + move.move.name.slice(1));
                    if (basicMoves.length === 0) {
                        // Fallback: primeiros 4 ataques se nenhum no nível 1
                        basicMoves.push(...details.moves.slice(0, 4).map(move => move.move.name.charAt(0).toUpperCase() + move.move.name.slice(1)));
                    }
                    
                    const card = document.createElement('div');
                    card.className = 'pokemon-card';
                    card.innerHTML = `
                        <img src="${details.sprites.front_default}" alt="${details.name}">
                        <h3>${details.name.charAt(0).toUpperCase() + details.name.slice(1)}</h3>
                        <p>ID: ${details.id}</p>
                        <div class="types">
                            <strong>Tipos:</strong>
                            <ul>${details.types.map(t => `<li>${t.type.name.charAt(0).toUpperCase() + t.type.name.slice(1)}</li>`).join('')}</ul>
                        </div>
                        <div class="moves">
                            <strong>Ataques Básicos:</strong>
                            <ul>${basicMoves.map(move => `<li>${move}</li>`).join('')}</ul>
                        </div>
                    `;
                    pokemonContainer.appendChild(card);
                } catch (error) {
                    console.error('Erro ao buscar detalhes do Pokémon:', error);
                }
            }
        }

        // Carrega os Pokémons ao carregar a página (mas só quando a seção for ativada)
        // Para otimizar, carregar apenas quando a seção do catálogo for mostrada
        let catalogLoaded = false;
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            if (sectionId === 'catalog' && !catalogLoaded) {
                fetchPokemons();
                catalogLoaded = true;
            }
        }
    </script>
</body>
</html>
